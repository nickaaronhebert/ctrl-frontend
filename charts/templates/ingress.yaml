apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
    name: '{{ if ne $.Values.ctrlEnv "prod" }}{{ $.Values.ctrlEnv }}-{{ end }}frontend-ctrl-public'
    annotations:
        alb.ingress.kubernetes.io/scheme: internet-facing
        alb.ingress.kubernetes.io/target-type: ip
        alb.ingress.kubernetes.io/certificate-arn: {{ join "," .Values.aws.certificates }}
        alb.ingress.kubernetes.io/listen-ports: '[{"HTTP": 80}, {"HTTPS":443}]'
        alb.ingress.kubernetes.io/ssl-redirect: '443'
        alb.ingress.kubernetes.io/group.name: 'telegramd-ctrl-public'
spec:
    ingressClassName: alb
    rules:
        - host: 'ctrl{{ if ne $.Values.ctrlEnv "prod" }}-{{ $.Values.ctrlEnv }}{{ end }}.{{ $.Values.domainName }}'
          http:
            paths:
              - path: /
                pathType: Prefix
                backend:
                  service:
                    name: {{ .Values.frontendService.name }}-svc
                    port:
                      number: {{ .Values.frontendService.externalPort }}
